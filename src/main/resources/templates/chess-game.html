<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>체스</title>
    <script>
        let first = '';
        let second = '';

        function clicked(id) {
            if (first !== '') {
                second = id;
            } else {
                first = id;
            }

            if (first !== '' && second !== '') {
                sendToServer(first, second);
                first = '';
                second = '';
            }
        }

        function sendToServer(first, second) {
            fetch('/move', {
                method: "POST",
                headers: {
                    "Content-Type": "text/plain",
                },
                body: "command=move " + first + " " + second
            }).then((response) => {
                    response.json().then(data => {
                        if (data.status === 400) {
                            alert(data.errorMessage);
                        }
                        location.reload();
                    });
                }
            );
        }

    </script>
</head>
<body>
<table>
    {{#board}}
    {{#dto}}
    <tr>
        {{#this}}
        {{#this}}
        <td id={{position}} onclick="clicked(this.id)">
            {{name}}
        </td>
        {{/this}}
        {{/this}}
    </tr>
    {{/dto}}
    {{/board}}
</table>
<br/>
<label> 명령어
    <input type="text" id="command" name="command"/>
</label>
<button id="btn" onclick="sendToServer(first, second)">제출</button>
</body>
</html>
